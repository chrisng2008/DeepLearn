[toc]
# 模型选择 & 过拟合和欠拟合


## 模型选择
### 训练误差和泛化误差
- 训练误差：模型在训练数据上的误差
- 泛化误差：模型在新数据上的误差


### 验证数据集和测试数据集
- 验证数据集：一个用来评估模型好坏的数据集
  - 例如拿50%作为训练集 
  - 不要跟训练数据混到一起(易发生错误)

### K-则交叉验证
- 在没有足够多数据时使用
- 算法：
  - 将训练数据分割成K块
  - For i = 1,...,k
    - 使用第i块作为验证数据集，其余作为训练数据集
  - 报告K个验证集误差的平均
- 常用：K=5或10

### 总结
- 训练数据集：训练模型参数
- 验证数据集：选择模型超参数
- 非大型数据集上通常使用k折交叉验证

## 过拟合和欠拟合
究竟用复杂的模型还是简单的模型，主要看我们的数据的复杂度。
![图 1](assest/%E6%A8%A1%E5%9E%8B%E9%80%89%E6%8B%A9%26%E8%BF%87%E6%8B%9F%E5%90%88%E5%92%8C%E6%AC%A0%E6%8B%9F%E5%90%88/IMG_20220901-221226911.png)  

### 模型容量
- 拟合各种函数的能力
- 低容量的模型难以拟合训练数据
- 高容量的模型可以记住所有的训练数据

### 模型容量的影响
我们应该选择较为适中的模型容量
![图 2](assest/%E6%A8%A1%E5%9E%8B%E9%80%89%E6%8B%A9%26%E8%BF%87%E6%8B%9F%E5%90%88%E5%92%8C%E6%AC%A0%E6%8B%9F%E5%90%88/IMG_20220901-221643823.png)  


### 估计模型容量
- 模型容量是可以估计的，但是难以在不用类型算法之间比较
  - 例如树模型和神经网络
- 给定一个模型种类，将有两个主要因素
  - 参数的个数
  - 参数值的选择范围
  ![图 3](assest/%E6%A8%A1%E5%9E%8B%E9%80%89%E6%8B%A9%26%E8%BF%87%E6%8B%9F%E5%90%88%E5%92%8C%E6%AC%A0%E6%8B%9F%E5%90%88/IMG_20220901-223623158.png)  
  通常来说，线性模型的模型容量为$d+1$, 其中+1为bias。, 神经网络的模型容量为$(d+1)m+(m+1)k$

### VC维
> 林轩田的课中有介绍VC维

- 统计学习理论的一个核心思想
- 对于一个分类模型，VC等于一个最大的数据集的大小，不管如何给定标号，都存在一个模型来对它进行完美分类

#### 线性分类器的VC维
- 2维输入的感知机，VC维=3
  - 能够分类任何三个点，但不是4个(XOR)
  - 支持N维输入的感知机的VC维是N+1
  - 一些多层感知机的VC维是$O(N\log_{2}N)$

#### VC维的用处
- 通过为什么一个模型号的理论依据
  - 它可以衡量训练误差和泛化误差之间的间隔
- 但深度学习中很少使用
  - 衡量不是很准确
  - 计算深度学习模型的VC维很困难

#### 数据复杂度
- 多个重要因素
  - 样本个数
  - 每个样本的元素个数
  - 时间、空间结构
  - 多样性


### 总结
- 模型容量需要匹配数据复杂度，否则可能导致欠拟合和过拟合
- 统计机器学习提供数学工具来衡量模型的复杂度
- 实际中一般靠观察训练误差和验证误差