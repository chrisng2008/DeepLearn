# RNN

## 潜变量自回归模型
- 使用潜变量$h_t$总结过去信息

![图 1](assest/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/IMG_20221019-221638305.png)  


## 循环神经网络
- 更新隐藏状态: $h_t = \phi(w_{hh}h_{t-1} + W_{ht}x_{t-1} + b_h)$
    > 去掉第一项$w_{hh}h_{t-1}$就退化成了MLP
- 输出: $\phi(W_{ho}h_t + b_o)$
![图 2](assest/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/IMG_20221019-222837973.png)  
我们根据$h_t$就能够形成输出
更新隐藏状态: $h_t = \phi(w_{hh}h_{t-1} + W_{ht}x_{t-1} + b_h)$
新状态由前一个隐藏状态和输入共同生成
输出：$o_t=\phi(W_{ho}h_t+b_o)$

## 总结
- 循环神经网络的输出取决于当前输入和前一时间的隐变量
- 应用到语言模型中时，循环神经网络根据当前词预测下一次时刻词
- 通常使用困惑度来衡量语言模型的好坏